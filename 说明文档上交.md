# Hymmnos-Rootkit 说明文档

## 什么是 Hymmnos-Rootkit
Hymmnos-Rootkit 是一个以 C 语言写成的，可以被加载进 Linux 内核的 Rootkit 模块。通过 Hymmnos-Rootkit 可以实现如进程隐藏、权限获取、数据包监控等功能。

## 测试环境
Linux 4.15.0-38-generic

## 功能清单
- 隐藏 Rootkit 自身
	- 隐藏 Rootkit 文件夹
	- 从模块加载列表中隐藏
- 隐藏特定进程
	- 通过开关字符串隐藏包含改字符串的命令
	- 通过 Kill 命令给进程发送隐藏信号
	- 隐藏该被隐藏进程的TCP连接信息
- 隐藏特定文件和内容
	- 通过开关字符串隐藏以该字符串作为后缀的文件
	- 隐藏文件内容中特点标签文本
- 监控数据
	- 记录http请求
	- 记录可能包含密码的内容
	- 搜集包括特定内容的数据包并记录
- 监控模块加载信息
- 获取 root 权限

## 编译及安装
    $ cd ~
    $ git clone https://github.com/flysoar/Hymmnos-rootkit.git
    $ cd Hymmnos-rootkit
    $ make
    $ sudo insmod hymmnos.ko
	
## 配置
|选项|默认值|说明|
|---|---|---|
|`SIGROOT`|48|隐藏信号|
|`SIGHIDEPROC`|49|隐藏信号|
|`SIGHIDEHYMMNOS`|50|隐藏 Rootkit 自身信号|
|`SIGHIDECONTENT`|51|隐藏文件内容信号|
|`SIGBACKDOOR`|52|网络监控信号|
|`SIGKOMON`|53|监控模块加载信号|
|`FILE_SUFFIX`|.reyvateil||
|`COMMAND_CONTAINS`|ceil||
|`ROOTKIT_NAME`|hymmnos||
|`HIDETAGIN`|<touwaka>|文件内容隐藏开始标签|
|`HIDETAGOUT`|</touwaka>|文件内容隐藏结束标签|
|`SHELL`|/home/flysoar/test||
|`TCPPORT`|7777||
|`UDPPORT`|7777||
|`TOKEN`|tonelico||
|`WORKNAME`|ceil||

## 测试
- 隐藏 Rootkit 文件夹
	1. 模块安装之前；文件夹存在
	![hide_document_after](/screenshot/test-1.png)
	
	2. 模块安装之后；文件夹隐藏
	![hide_document_after](/screenshot/test-2.png)

	3. 模块卸载时候；文件夹存在
	![hide_document_after](/screenshot/test-3.png)

- 隐藏进程
	1. 安装模块之前ps -aux；可以看到13086进程（这个是gedit hymmnos.c进程，图中可以看到）。安装模块之后可以看到该进程还存在
	![hide_document_after](/screenshot/test-4.png)

	2. 但是此时使用ps -aux看不到13086进程；但实际上该进程还在运行。只是隐藏了。
	![hide_document_after](/screenshot/test-5.png)

	3. 卸载模块之后。
	![hide_document_after](/screenshot/test-6.png)

- 隐藏模块

	测试kill -50的功能；将模块隐藏或显示；隐藏时显示；显示时隐藏
	![hide_document_after](/screenshot/test-7.png)

- 获取权限

	测试kill -48 ;获取root权限；使用whoami查看是否测试成功
	![hide_document_after](/screenshot/test-8.png)


- 隐藏特定文件
	1. 未加载模块时的文件存在
	![hide_document_after](/screenshot/test-9.png)

	2. 加载模块之后，文件被隐藏
	![hide_document_after](/screenshot/test-10.png)

	3. 卸载模块之后，隐藏的文件被显示
	![hide_document_after](/screenshot/test-11.png)

- 使用kill -51命令可以隐藏或显示文件内容
	1. 首先在当前目录下新建一个文件，内容可定义如下（实际上只要包含<touwaka>标签就可以）；此时模块还没有有加载；并且内容是显示的。
	![hide_document_after](/screenshot/test-12.png)

	2. 接着加载模块，此时文件内容中的<touwaka>标签中的内容被隐藏。
	![hide_document_after](/screenshot/test-13.png)
	
	3. 分别使用kill -51命令可以隐藏或显示文件内容
	![hide_document_after](/screenshot/test-14.png)

- 对包含指定字段的进程隐藏

	1. 加载模块之前，能看到含有“ceil”字段的进程
	![hide_document_after](/screenshot/test-15.png)

	2. 加载模块之后看不到含有“ceil”字段的进程
	![hide_document_after](/screenshot/test-16.png)

	3. 卸载之后又可以看到含有“ceil”字段进程
	![hide_document_after](/screenshot/test-17.png)